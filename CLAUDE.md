# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Important Context
- IMPORTANT: Отвечай и пиши комментарии и документацию  на русском языке
- Be brutally honest, don't be a yes man. If I am wrong, point it out bluntly.
- I need honest feedback on my code.
-
## Code Quality
**ВАЖНО**: После внесения изменений в код необходимо:
1. Запустить линтер командой `make lint` или `golangci-lint run`
2. Исправить все обнаруженные линтером ошибки и предупреждения
3. Убедиться, что код соответствует настроенным в `.golangci.yml` правилам
4. Только после успешного прохождения линтера считать задачу выполненной
5. Сделать commit полноценный. Не указывай себя в авторах

# Правила использования MCP инструментов

## Общие принципы
- **ПРИОРИТЕТ**: Всегда используй MCP инструменты вместо стандартных поисковых инструментов для Go кода
- **ЭФФЕКТИВНОСТЬ**: MCP инструменты предоставляют более точную и структурированную информацию
- **ПОСЛЕДОВАТЕЛЬНОСТЬ**: Используй инструменты в правильном порядке для максимальной эффективности

## 1. MCP gopls - Навигация и анализ Go кода

### Когда использовать:
- **ВСЕГДА** для навигации по Go коду
- При поиске определений функций, типов, переменных
- Для поиска всех реализаций интерфейса
- При рефакторинге (переименование символов)
- Для поиска всех использований символа
- При анализе структуры кода
- Для получения информации о символах (hover)

### Приоритет инструментов gopls:
1. **mcp__mcp-gopls__GoToDefinition** - переход к определению
2. **mcp__mcp-gopls__FindReferences** - поиск всех использований
3. **mcp__mcp-gopls__FindImplementers** - поиск реализаций интерфейса
4. **mcp__mcp-gopls__Hover** - информация о символе
5. **mcp__mcp-gopls__ListDocumentSymbols** - структура файла
6. **mcp__mcp-gopls__SearchSymbol** - поиск символов по имени
7. **mcp__mcp-gopls__RenameSymbol** - переименование
8. **mcp__mcp-gopls__GetDiagnostics** - ошибки и предупреждения
9. **mcp__mcp-gopls__FormatCode** - форматирование кода
10. **mcp__mcp-gopls__OrganizeImports** - организация импортов

### Примеры использования:
```
// Поиск определения функции
mcp__mcp-gopls__GoToDefinition(file, line, column)

// Поиск всех использований переменной
mcp__mcp-gopls__FindReferences(file, line, column)

// Поиск всех реализаций интерфейса
mcp__mcp-gopls__FindImplementers(file, line, column)
```

## 2. MCP godoc - Документация Go пакетов

### Когда использовать:
- **ВСЕГДА** перед чтением исходного кода пакета
- При изучении API стандартной библиотеки
- Для понимания внешних зависимостей
- При работе с локальными пакетами
- Для получения примеров использования

### Приоритет использования:
1. **Сначала** - базовая документация пакета
2. **Затем** - конкретные символы (функции, типы)
3. **При необходимости** - исходный код с флагом -src

### Примеры использования:
```
// Базовая документация пакета
mcp__godoc-mcp__get_doc(path="net/http")

// Документация конкретной функции
mcp__godoc-mcp__get_doc(path="net/http", target="HandleFunc")

// Полная документация с примерами
mcp__godoc-mcp__get_doc(path="io", cmd_flags=["-all"])
```

## 3. MCP context7 - Документация библиотек

### Когда использовать:
- При работе с внешними библиотеками (не Go)
- Для изучения фреймворков и инструментов
- При поиске примеров использования
- Для получения актуальной документации

### Процесс работы:
1. **Всегда** сначала вызывай `resolve-library-id`
2. **Затем** используй полученный ID для `get-library-docs`

### Примеры использования:
```
// Поиск ID библиотеки
mcp__context7__resolve-library-id(libraryName="mongodb")

// Получение документации
mcp__context7__get-library-docs(context7CompatibleLibraryID="/mongodb/docs")
```

## 4. MCP ide - Диагностика IDE

### Когда использовать:
- Для получения диагностической информации
- При отладке проблем с IDE
- Дополнительно к gopls диагностике

## Workflow для работы с Go кодом:

### 1. Изучение нового кода:
```
1. mcp__mcp-gopls__ListDocumentSymbols - структура файла
2. mcp__godoc-mcp__get_doc - документация пакета
3. mcp__mcp-gopls__Hover - детали по символам
4. mcp__mcp-gopls__GoToDefinition - переход к определениям
```

### 2. Поиск функциональности:
```
1. mcp__mcp-gopls__SearchSymbol - поиск по имени
2. mcp__godoc-mcp__get_doc - проверка документации
3. mcp__mcp-gopls__FindReferences - где используется
```

### 3. Рефакторинг:
```
1. mcp__mcp-gopls__FindReferences - найти все использования
2. mcp__mcp-gopls__RenameSymbol - переименовать
3. mcp__mcp-gopls__GetDiagnostics - проверить ошибки
4. mcp__mcp-gopls__FormatCode - форматировать код
```

### 4. Анализ интерфейсов:
```
1. mcp__mcp-gopls__GoToDefinition - найти интерфейс
2. mcp__mcp-gopls__FindImplementers - найти реализации
3. mcp__godoc-mcp__get_doc - документация интерфейса
```

## Важные правила:

1. **НЕ используй** стандартные инструменты поиска для Go кода
2. **ВСЕГДА** начинай с MCP инструментов
3. **Используй** gopls для навигации и анализа
4. **Используй** godoc для документации перед чтением кода
5. **Комбинируй** инструменты для максимальной эффективности

## Приоритет инструментов (от высокого к низкому):
1. MCP gopls - для всей работы с Go кодом
2. MCP godoc - для документации Go пакетов
3. MCP context7 - для внешних библиотек
4. MCP ide - для диагностики
5. Стандартные инструменты - только если MCP недоступен
